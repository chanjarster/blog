---
title: "JVM - Stringå¯¹è±¡åœ¨Java 9ä¸­çš„å˜åŒ–"
author: "é¢‡å¿’è„±"
tags: ["ARTS", "ARTS-T", "jvm"]
date: 2020-05-21T08:55:08+08:00
---

<!--more-->

## æ¦‚è¦

åœ¨Java 9ä¸­ï¼ŒStringå¯¹è±¡åº•å±‚ä»åŸæ¥çš„`char[]`å˜æˆäº†`byte[]`ï¼Œè¿™ä¸€å˜åŒ–å¸¦æ¥çš„ç›´æ¥å¥½å¤„å°±æ˜¯æ›´èŠ‚çœå†…å­˜äº†ï¼Œå› æ­¤ä¹Ÿè¢«ç§°ä¸ºCompact Strings Improvementã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºåœ¨Javaä¸­`char`å æœ‰2ä¸ªå­—èŠ‚ï¼Œ`byte`å ç”¨1ä¸ªå­—èŠ‚ï¼Œè€Œä¸€ä¸ªUnicodeå­—ç¬¦çš„è¡¨ç¤ºå¹¶ä¸ä¸€å®šéœ€è¦2ä¸ªå­—èŠ‚ï¼Œè‡³å°‘ASCIIå­—ç¬¦åªéœ€è¦1ä¸ªå­—èŠ‚å°±æå®šäº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä½ çš„å­—ç¬¦ä¸²é‡Œéƒ½æ˜¯ASCIIå­—ç¬¦ï¼Œå¦‚æœç”¨charçš„è¯å°±ä¼šæµªè´¹ä¸€åŠçš„ç©ºé—´ã€‚

## ç®€è¦Unicodeè¯´æ˜

è¯´åˆ°è¿™é‡Œä¸å¾—ä¸æä¸€ä¸‹Unicodeç¼–ç ï¼Œä»¥åŠå®ƒçš„Code Pointï¼ˆç ç‚¹ï¼‰å’ŒCode Unitã€‚å¯ä»¥æŠŠUnicodeæƒ³è±¡æˆä¸€å¼ å·¨å¤§çš„è¡¨æ ¼ï¼Œæ¯ä¸ªå­—ç¬¦éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€å¯¹åº”çš„æ•°å­—ã€‚

ä¸€ä¸ªCode Pointä»£è¡¨äº†ä¸€ä¸ªUnicodeå­—ç¬¦çš„åœ¨è¡¨ä¸­çš„åºå·ï¼š

```
> 'A'.codePointAt(0).toString(16)
'41'
> 'Ï€'.codePointAt(0).toString(16)
'3c0'
> 'ğŸ™‚'.codePointAt(0).toString(16)
'1f642'
```

ä¸€ä¸ªæˆ–è€…å¤šä¸ªCode Unitä»£è¡¨äº†ä¸€ä¸ªCode Pointï¼ŒCode Unitæ˜¯ç”¨æ¥å­˜å‚¨å’Œä¼ è¾“Unicodeå­—ç¬¦çš„ï¼Œä»¥ä¸‹æ˜¯UTF-8ç¼–ç ï¼š

| Character | Code point | Code units                             |
| --------- | ---------- | -------------------------------------- |
| A         | 0x0041     | 01000001                               |
| Ï€         | 0x03C0     | 11001111, 10000000                     |
| ğŸ™‚       | 0x1F642    | 11110000, 10011111, 10011001, 10000010 |

UTF-8çš„Code Unitå ç”¨8ä½ï¼ˆ1å­—èŠ‚ï¼‰ï¼ŒUTF-16çš„Code Unitå ç”¨16ä½ï¼ˆ2å­—èŠ‚ï¼‰ï¼ŒUTF-32çš„Code Unitå ç”¨32ä½ï¼ˆ4å­—èŠ‚ï¼‰ï¼Œé™¤äº†UTF-32ä¹‹å¤–ï¼ŒUTF-8/16éƒ½æ˜¯å˜é•¿ç¼–ç ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨å¯¹ä¸€ä¸ªCode Pointè½¬æ¢æˆCode Unitçš„æ—¶å€™ï¼Œæ ¹æ®æƒ…å†µä½¿ç”¨1ä¸ªæˆ–å¤šä¸ªCode Unitï¼ˆä¸Šé¢è¡¨æ ¼å·²ç»è¯´æ˜äº†ï¼‰ã€‚

æ‰€ä»¥ï¼Œå½“Java 9 Stringåº•å±‚ä»`char[]`æ”¹æˆ`byte[]`ï¼Œé™¤éä½¿ç”¨UTF-32ç¼–ç ï¼ˆå®šé•¿ç¼–ç ï¼‰ï¼Œé‚£ä¹ˆå®ƒè‚¯å®šæ˜¯å˜é•¿ç¼–ç ï¼Œä½¿å¾—å†…å­˜å ç”¨æ›´ç´§å‡‘ã€‚ä¹Ÿå› æ­¤Java 9 String APIä¸­æ·»åŠ äº†å…³äºCode Pointçš„æ–¹æ³•ã€‚

## å‚è€ƒæ–‡æ¡£

* [Unicode â€“ a brief introduction](https://exploringjs.com/impatient-js/ch_unicode.html)
* [Java 9 â€“ Compact Strings Improvement [JEP 254]](https://howtodoinjava.com/java9/compact-strings/)
* [Java 9 String API](https://docs.oracle.com/javase/9/docs/api/java/lang/String.html)

